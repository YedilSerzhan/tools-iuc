<tool id="beta_diversity" name="calculates beta diversity (Bray-Curtis dissimilarity)" version="0.1.0+galaxy0" python_template_version="3.5" profile="21.05">
    <description>from kraken, krona and bracken files</description>
    <requirements>
        <requirement type="package" version="1.2">krakentools</requirement>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
beta_diversity.py 
    --inputs
    #for $input in $inputs 
        '$input' 
    #end for
    --type '$type'
    --level '$level'
    > '$output'
    ]]></command>
    <inputs>
        <param argument="--inputs" type="data" multiple="true" format="tabular" label="Taxonomy file(s)" help="The files can be generated by Kraken, Bracken or Krona"/>
        <param argument="--type" type="select" label="Specify type of input file(s)">
            <option value="single" selected="true">Single tabular data file</option>
            <option value="simple">Tabular data files</option>
            <option value="bracken">Braken species abundance file</option>
            <option value="kreport">Kraken report file</option>
            <option value="krona">Krona file</option>
        </param>
        <param argument="--level" type="select" label="Specify which level to measure at">
            <option value="all" selected="true">All</option>
            <option value="S">Species</option>
            <option value="G">Genera</option>
            <option value="F">Family</option>
            <option value="O">Order</option>
        </param>
    </inputs>
    <outputs>
        <data name="output" format="txt" />
    </outputs>
    <tests>
        <test>
            <param name="inputs" value="beta_bracken_1.tabular,beta_bracken_2.tabular,beta_bracken_3.tabular"/>
            <param name="type" value="bracken"/>
            <output name="output" ftype="txt">
                <assert_contents>
                    <has_text text="0.629"/>
                    <has_text text="0.993"/>
                    <has_text text="0.995"/>
                </assert_contents>
            </output>
        </test>
        <test>
            <param name="inputs" value="beta_kreport_1.tabular,beta_kreport_2.tabular,beta_kreport_3.tabular"/>
            <param name="type" value="kreport"/>
            <output name="output" ftype="txt">
                <assert_contents>
                    <has_text text="0.584"/>
                    <has_text text="0.996"/>
                    <has_text text="0.995"/>
                </assert_contents>
            </output>
        </test>
    </tests>
    <help><![CDATA[
        usage: beta_diversity.py [-h] -i IN_FILES [IN_FILES ...]
                         [--type {single,simple,bracken,kreport,kreport2,krona}]
                         [--cols COLS] [--level {all,S,G,F,O}]

        optional arguments:
          -h, --help            show this help message and exit

          -i IN_FILES [IN_FILES ...], --input IN_FILES [IN_FILES ...], --input-files IN_FILES [IN_FILES ...], --inputs IN_FILES [IN_FILES ...]
                                Input files (one per community) for which to compare
                                for bray-curtis dissimiliarity metrics

          --type {single,simple,bracken,kreport,kreport2,krona}
                                Type of input file[s]: single, simple [tab-delimited,
                                specify --cols], bracken, kreport, kreport2, krona.
                                See docs for details

          --cols COLS, --columns COLS
                                Specify category/counts separated by single comma:
                                cat,counts (1 = first col)

          --level {all,S,G,F,O}, -l {all,S,G,F,O}
                                For Kraken or Krona files, taxonomy level for which to
                                compare samples. Default: all

    ]]></help>
    <citations>
        <citation type="doi">
@misc{
  author = {Lu, Jennifer},
  year = {2022},
  title = {Metagenome analysis using the Kraken software suite},
  url = {https://www.nature.com/articles/s41596-022-00738-y},
}</citation>
    </citations>
</tool>