<tool id="beta_diversity" name="calculates beta diversity (Bray-Curtis dissimilarity)" version="0.1.0+galaxy0" python_template_version="3.5" profile="21.05">
    <description>from kraken, krona and bracken files</description>
    <requirements>
        <requirement type="package" version="1.2">krakentools</requirement>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
beta_diversity.py 
    -i '$input1' 
    #for $i, $s in enumerate($inputs)
        '${s.input}'
    #end for
    --type '$type' > '$output'
    ]]></command>
    <inputs>
        <param type="data" name="input1" format="tabular" />
        <repeat name="inputs" title="Inputs">
            <param name="input" type="data" format="tabular" label="Dataset"/>
        </repeat>
        <param argument="--type" type="select" label="Specify type of input file(s)">
            <option value="single" selected="true">a single tab-delimited file (1st col is the category and the rest are counts)</option>
            <option value="simple">Tab-delimited file, specify --cols</option>
            <option value="bracken">Braken species abundance</option>
            <option value="kreport">Kraken report</option>
            <option value="krona">Krona</option>
        </param>
    </inputs>
    <outputs>
        <data name="output" format="txt" />
    </outputs>
    <tests>
        <test>
            <param name="input1" value="beta_bracken_1.tabular"/>
            <param name="type" value="bracken"/>
            <repeat name="inputs">
                <param name="input" value="beta_bracken_2.tabular" ftype="tabular"/>
            </repeat>
             <repeat name="inputs">
                <param name="input" value="beta_bracken_3.tabular" ftype="tabular"/>
            </repeat>
            <output name="output" ftype="txt">
                <assert_contents>
                    <has_text text="0.629"/>
                    <has_text text="0.993"/>
                    <has_text text="0.995"/>
                </assert_contents>
            </output>
        </test>
        <test>
            <param name="input1" value="beta_kreport_1.tabular"/>
            <param name="type" value="kreport"/>
            <repeat name="inputs">
                <param name="input" value="beta_kreport_2.tabular" ftype="tabular"/>
            </repeat>
             <repeat name="inputs">
                <param name="input" value="beta_kreport_3.tabular" ftype="tabular"/>
            </repeat>
            <output name="output" ftype="txt">
                <assert_contents>
                    <has_text text="0.584"/>
                    <has_text text="0.996"/>
                    <has_text text="0.995"/>
                </assert_contents>
            </output>
        </test>
    </tests>
    <help><![CDATA[
        usage: beta_diversity.py [-h] -i IN_FILES [IN_FILES ...]
                         [--type {single,simple,bracken,kreport,kreport2,krona}]
                         [--cols COLS] [--level {all,S,G,F,O}]

optional arguments:
  -h, --help            show this help message and exit
  -i IN_FILES [IN_FILES ...], --input IN_FILES [IN_FILES ...], --input-files IN_FILES [IN_FILES ...], --inputs IN_FILES [IN_FILES ...]
                        Input files (one per community) for which to compare
                        for bray-curtis dissimiliarity metrics
  --type {single,simple,bracken,kreport,kreport2,krona}
                        Type of input file[s]: single, simple [tab-delimited,
                        specify --cols], bracken, kreport, kreport2, krona.
                        See docs for details
  --cols COLS, --columns COLS
                        Specify category/counts separated by single comma:
                        cat,counts (1 = first col)
  --level {all,S,G,F,O}, -l {all,S,G,F,O}
                        For Kraken or Krona files, taxonomy level for which to
                        compare samples. Default: all

    ]]></help>
    <citations>
        <citation type="doi">
@misc{
  author = {Lu, Jennifer},
  year = {2022},
  title = {Metagenome analysis using the Kraken software suite},
  url = {https://www.nature.com/articles/s41596-022-00738-y},
}</citation>
    </citations>
</tool>