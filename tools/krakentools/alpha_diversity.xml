<tool id="alpha_diversity" name="Calculates alpha diversity" version="0.1.0+galaxy0" python_template_version="3.5" profile="21.05">
    <description>from the Bracken abundance estimation file</description>
    <requirements>
        <requirement type="package" version="1.2">krakentools</requirement>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
python alpha_diversity.py 
    --filename '$filename'
    --alpha '$alpha'
    ]]></command>
    <inputs>
        <param argument="--filename" type="data" format="tabular" label="Braken abundance file" />
        <param argument="--alpha" type="select" label="Specify advanced parameters">
            <option value="Sh" selected="true">Shannon's alpha diversity</option>
            <option value="BP">Berger-Parker's alpha</option>
            <option value="Si">Simpson's diversity</option>
            <option value="ISi">Inverse Simpson's diversity</option>
            <option value="F">Fisher's index</option>
        </param>
    </inputs>
    <outputs>
    </outputs>
    <tests>
        <test>
            <param name="filename" value="bracken_abundance.tabular"/>
            <assert_command>
                <has_text text="Shannon's diversity: 4.194127607417342" />
            </assert_command>
        </test>
        <test>
            <param name="filename" value="bracken_abundance.tabular"/>
            <param name="alpha" value="BP"/>
            <assert_command>
                <has_text text="Berger-parker's diversity: 0.05525121757950085" />
            </assert_command>
        </test>
        <test>
            <param name="filename" value="bracken_abundance.tabular"/>
            <param name="alpha" value="Si"/>
            <assert_command>
                <has_text text="Simpson's diversity: 0.9805668888241948" />
            </assert_command>
        </test>
        <test>
            <param name="filename" value="bracken_abundance.tabular"/>
            <param name="alpha" value="ISi"/>
            <assert_command>
                <has_text text="Simpson's Reciprocal Index: 51.45856424909617" />
            </assert_command>
        </test>
        <test>
            <param name="filename" value="bracken_abundance.tabular"/>
            <param name="alpha" value="F"/>
            <assert_command>
                <has_text text="Fisher's index: 1688.9352909860668" />
            </assert_command>
        </test>
    </tests>
    <help><![CDATA[
        Usage/options:
            python alpha_diversity.py
                -f, --filename MYFILE.BRACKEN..........Bracken output file
                -a, --alpha TYPE.......................Single letter alpha diversity type (Sh, BP, Si, ISi, F)

        Input Bracken file must be in standard Bracken output file format and must be run specifically for Abundance Estimation. Example format:
            name                     tax_id tax_lvl kraken... added... new...  fraction...
            Homo sapiens             9606   S       ...        ....    999000  0.999000
            Streptococcus pyogenes   1314   S       ...        ....    10      0.000001
            Streptococcus agalactiae 1311   S       ...        ....    5       0.000000
            Streptococcus pneumoniae 1313   S       ...        ....    3       0.000000
            Bordetella pertussis     520    S       ...        ....    20      0.000002
    ]]></help>
    <citations>
        <citation type="doi">
@misc{
  author = {Lu, Jennifer},
  year = {2022},
  title = {Metagenome analysis using the Kraken software suite},
  url = {https://www.nature.com/articles/s41596-022-00738-y},
}</citation>
    </citations>
</tool>